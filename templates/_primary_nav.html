{# Единая шапка/навигация для всего проекта (премиум-минимализм) #}
{# Ожидаемые переменные: active_page (dashboard|schedule|generator|plans|reminders|templates|admin|None) #}
<header class="nav-primary">
    <div class="nav-brand">
        {% if current_user and current_user.is_authenticated %}
        <div class="nav-user-actions">
            <div class="profile-dropdown">
                <a href="{{ url_for('auth.user_profile') }}" class="user-profile-avatar nav-dropdown-trigger {% if current_user.is_creator() %}creator{% endif %}" title="{{ current_user.username }}">
                    {% if current_user.avatar_url %}<img src="{{ current_user.avatar_url }}" alt="Avatar">{% else %}{{ current_user.username[0].upper() }}{% endif %}
                </a>
                
                <div class="profile-dropdown-content">
                    <a href="{{ url_for('auth.user_profile') }}" class="profile-item">
                        <img src="{{ url_for('static', filename='icons/icons8-пользователь-100.png') }}" alt="Profile">
                        <span>Профиль</span>
                    </a>
                    
                    {% if current_user.is_creator() %}
                    <a href="{{ url_for('admin.admin_panel') }}" class="profile-item {% if active_page == 'admin' %}active{% endif %}">
                        <img src="{{ url_for('static', filename='icons/icons8-интеграция-100.png') }}" alt="Admin">
                        <span>Админка</span>
                    </a>
                    {% endif %}
                    
                    <div style="border-top: 1px solid var(--stroke-1); margin: 0.4rem 0;"></div>
                    
                    <a href="{{ url_for('auth.logout') }}" class="profile-item" style="color: var(--danger);">
                        <img src="{{ url_for('static', filename='icons/icons8-выход-100.png') }}" alt="Logout" style="filter: hue-rotate(-150deg);">
                        <span>Выход</span>
                    </a>
                </div>
            </div>
        </div>
        {% endif %}
        
        <a href="{{ url_for('main.index') }}" style="text-decoration: none; display: flex; align-items: center; gap: 1rem; color: inherit;">
            <div class="brand-mark">LOGO</div>
            <div class="brand-caption">Слот под фирменный знак</div>
        </a>
    </div>

    {% include '_mobile_menu.html' %}

    <nav class="nav-links">
        <a href="{{ url_for('main.dashboard') }}" class="nav-link {% if active_page == 'dashboard' %}active{% endif %}">
            <span class="nav-link-content">
                <img src="{{ url_for('static', filename='icons/students_white-no-bg-preview (carve.photos).png') }}" alt="Ученики" class="nav-link-icon">
                <span class="nav-link-label">Ученики</span>
            </span>
        </a>

        <a href="{{ url_for('schedule.schedule') }}" class="nav-link {% if active_page == 'schedule' %}active{% endif %}">
            <span class="nav-link-content">
                <img src="{{ url_for('static', filename='icons/schedule_white.png') }}" alt="Расписание" class="nav-link-icon">
                <span class="nav-link-label">Расписание</span>
            </span>
        </a>

        <a href="{{ url_for('reminders.reminders_list') }}" class="nav-link {% if active_page == 'reminders' %}active{% endif %}">
            <span class="nav-link-content">
                <img src="{{ url_for('static', filename='icons/VREMYA.png') }}" alt="Напоминания" class="nav-link-icon">
                <span class="nav-link-label">Напоминания</span>
            </span>
        </a>

        {# Выпадающее меню для инструментов #}
        <div class="nav-dropdown">
            <div class="nav-link nav-dropdown-trigger {% if active_page in ['generator', 'plans', 'templates'] %}active{% endif %}">
                <span class="nav-link-content">
                    <img src="{{ url_for('static', filename='icons/icons8-меню-100.png') }}" alt="Инструменты" class="nav-link-icon">
                    <span class="nav-link-label">Инструменты</span>
                </span>
            </div>
            <div class="nav-dropdown-content">
                <a href="{{ url_for('kege_generator.kege_generator') }}" class="dropdown-item {% if active_page == 'generator' %}active{% endif %}">
                    <img src="{{ url_for('static', filename='icons/generator_white-no-bg-preview (carve.photos).png') }}" class="nav-link-icon">
                    <span>Генератор</span>
                </a>
                <a href="{{ url_for('main.update_plans') }}" class="dropdown-item {% if active_page == 'plans' %}active{% endif %}">
                    <img src="{{ url_for('static', filename='icons/notes_white-no-bg-preview (carve.photos).png') }}" class="nav-link-icon">
                    <span>Планы</span>
                </a>
                <a href="{{ url_for('templates.templates_list') }}" class="dropdown-item {% if active_page == 'templates' %}active{% endif %}">
                    <img src="{{ url_for('static', filename='icons/SHABL.png') }}" class="nav-link-icon">
                    <span>Шаблоны</span>
                </a>
            </div>
        </div>
    </nav>
</header>


