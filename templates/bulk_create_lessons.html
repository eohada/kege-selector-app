<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–∞—Å—Å–æ–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —É—Ä–æ–∫–æ–≤ ¬∑ –ß—ë—Ä–Ω—ã–π –Ω–µ–æ–Ω</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='modern_style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='toast.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='loading.css') }}">
    {% if csrf_token %}
    <meta name="csrf-token" content="{{ csrf_token() }}">
    {% endif %}
</head>
<body class="{% if active_lesson %}lesson-active{% endif %}">
    {% include '_active_lesson_banner.html' %}
    
    <div class="app-shell">
        <header class="nav-primary">
            <div class="nav-brand">
                {% if current_user and current_user.is_authenticated %}
                <a href="{{ url_for('auth.user_profile') }}" class="user-profile-avatar {% if current_user.is_creator() %}creator{% endif %}" title="{{ current_user.username }} ({{ current_user.get_role_display() }})">
                    {{ current_user.username[0].upper() }}
                </a>
                {% endif %}
                <a href="{{ url_for('main.index') }}" style="text-decoration: none; display: flex; align-items: center; gap: 1rem; color: inherit;">
                    <div class="brand-mark">LOGO</div>
                    <div class="brand-caption">–°–ª–æ—Ç –ø–æ–¥ —Ñ–∏—Ä–º–µ–Ω–Ω—ã–π –∑–Ω–∞–∫</div>
                </a>
            </div>
            {% include '_mobile_menu.html' %}
            <nav class="nav-links">
                <a href="{{ url_for('main.dashboard') }}" class="nav-link">üë• –£—á–µ–Ω–∏–∫–∏</a>
                <a href="{{ url_for('schedule.schedule') }}" class="nav-link">üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</a>
                <a href="{{ url_for('kege_generator.kege_generator') }}" class="nav-link">üíª –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä</a>
                <a href="{{ url_for('main.update_plans') }}" class="nav-link">üìù –ü–ª–∞–Ω—ã</a>
            </nav>
        </header>

        {% include '_ux_enhancements.html' %}

        <section class="glass-panel" style="margin-bottom: 2rem;">
            <div>
                <p class="hero-eyebrow">–º–∞—Å—Å–æ–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ</p>
                <h1 class="hero-title">üìÖ –ú–∞—Å—Å–æ–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —É—Ä–æ–∫–æ–≤</h1>
            </div>
        </section>

        <section class="glass-panel" style="margin-bottom: 2rem; border-left: 4px solid var(--accent-2);">
            <div style="background: rgba(31, 123, 255, 0.1); border-left: 3px solid var(--accent-2); border-radius: var(--radius-sm); padding: 1rem; color: var(--accent-2);">
                <strong style="display: block; margin-bottom: 0.5rem;">üí° –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</strong>
                <ol style="margin: 0.5em 0 0 1.5em; list-style: decimal;">
                    <li>–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —É—á–µ–Ω–∏–∫–∏ —Å–æ–∑–¥–∞–Ω—ã –≤ —Å–∏—Å—Ç–µ–º–µ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ platform_id</li>
                    <li>–í—Å—Ç–∞–≤—å—Ç–µ –¥–∞–Ω–Ω—ã–µ —É—Ä–æ–∫–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON –Ω–∏–∂–µ</li>
                    <li>–ù–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å —É—Ä–æ–∫–∏"</li>
                </ol>
            </div>
        </section>

        <section class="glass-panel">
            <form method="POST" data-validate>
                <div class="neo-field" style="margin-bottom: 1.5rem;">
                    <label class="neo-label" for="lessons_data">–î–∞–Ω–Ω—ã–µ —É—Ä–æ–∫–æ–≤ (JSON —Ñ–æ—Ä–º–∞—Ç)</label>
                    <textarea id="lessons_data" 
                              name="lessons_data" 
                              class="neo-textarea" 
                              placeholder='[
  {
    "platform_id": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω 123",
    "date": "2024-09-23",
    "time": "10:00",
    "duration": 60,
    "status": "completed"
  },
  {
    "platform_id": "–ü–µ—Ç—Ä–æ–≤ –ü–µ—Ç—Ä 456",
    "date": "2024-09-23",
    "time": "14:00",
    "duration": 60,
    "status": "completed"
  }
]'
                              style="min-height: 400px; font-family: 'MonaspaceNeon', 'Courier New', monospace; font-size: 0.9em;"
                              required></textarea>
                </div>
                
                <div class="glass-panel" style="background: var(--surface-2); padding: 1.5rem; margin-bottom: 1.5rem;">
                    <strong style="color: var(--text-primary); display: block; margin-bottom: 0.5rem;">–§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö:</strong>
                    <pre style="color: var(--accent-1); font-family: 'MonaspaceNeon', 'Courier New', monospace; font-size: 0.85em; white-space: pre-wrap; word-break: break-word; margin: 0;">[
  {
    "platform_id": "ID —É—á–µ–Ω–∏–∫–∞ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä: –ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω 123)",
    "date": "YYYY-MM-DD (–Ω–∞–ø—Ä–∏–º–µ—Ä: 2024-09-23)",
    "time": "HH:MM (–Ω–∞–ø—Ä–∏–º–µ—Ä: 10:00)",
    "duration": 60,  // –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –º–∏–Ω—É—Ç–∞—Ö (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 60)
    "status": "completed"  // —Å—Ç–∞—Ç—É—Å: completed, planned, cancelled (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é completed)
  }
]</pre>
                </div>
                
                <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                    <button type="submit" class="neo-button accent">üìÖ –°–æ–∑–¥–∞—Ç—å —É—Ä–æ–∫–∏</button>
                    <a href="{{ url_for('main.dashboard') }}" class="neo-button ghost">‚Üê –ù–∞–∑–∞–¥</a>
                </div>
            </form>
        </section>
    </div>
    
    {# Flash messages –±—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã —á–µ—Ä–µ–∑ toast #}
    <script src="{{ url_for('static', filename='toast.js') }}"></script>
    <script src="{{ url_for('static', filename='loading.js') }}"></script>
    <script src="{{ url_for('static', filename='audit-tracker.js') }}"></script>
    <script>
        // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º flash-—Å–æ–æ–±—â–µ–Ω–∏—è –≤ toast-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        {% if category == 'error' or category == 'danger' %}
                            if (typeof toast !== 'undefined' && toast) {
                                toast.error('{{ message|e }}');
                            } else if (window.toast) {
                                window.toast.error('{{ message|e }}');
                            }
                        {% elif category == 'warning' %}
                            if (typeof toast !== 'undefined' && toast) {
                                toast.warning('{{ message|e }}');
                            } else if (window.toast) {
                                window.toast.warning('{{ message|e }}');
                            }
                        {% elif category == 'info' %}
                            if (typeof toast !== 'undefined' && toast) {
                                toast.info('{{ message|e }}');
                            } else if (window.toast) {
                                window.toast.info('{{ message|e }}');
                            }
                        {% else %}
                            if (typeof toast !== 'undefined' && toast) {
                                toast.success('{{ message|e }}');
                            } else if (window.toast) {
                                window.toast.success('{{ message|e }}');
                            }
                        {% endif %}
                    {% endfor %}
                {% endif %}
            {% endwith %}
        });
    </script>
</body>
</html>
