<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard ¬∑ –ß—ë—Ä–Ω—ã–π –Ω–µ–æ–Ω</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='modern_style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='toast.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='loading.css') }}">
    {% if csrf_token %}
    <meta name="csrf-token" content="{{ csrf_token() }}">
    {% endif %}
</head>
<body class="{% if active_lesson %}lesson-active{% endif %}">
    {% if active_lesson %}
    <div class="now-playing-pill" onclick="toggleLessonMenu()">
        üéß –£—Ä–æ–∫ –∏–¥–µ—Ç: {{ active_student.name }}
    </div>
    <div class="now-playing-panel" id="lessonMenu">
        <div class="hero-eyebrow">—Ç–µ–∫—É—â–∏–π —É—Ä–æ–∫</div>
        <p style="margin: 0 0 0.4rem 0;"><strong>–£—á–µ–Ω–∏–∫:</strong> {{ active_student.name }}</p>
        {% if active_lesson.topic %}
        <p style="margin: 0 0 0.4rem 0;"><strong>–¢–µ–º–∞:</strong> {{ active_lesson.topic }}</p>
        {% endif %}
        <p style="margin: 0 0 0.4rem 0;"><strong>–î–∞—Ç–∞:</strong> {{ active_lesson.lesson_date.strftime('%d.%m.%Y %H:%M') }}</p>
        <p style="margin: 0;"><strong>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</strong> {{ active_lesson.duration }} –º–∏–Ω—É—Ç</p>
        <div class="hero-actions" style="margin-top: 1rem;">
            <form method="POST" action="{{ url_for('lesson_complete', lesson_id=active_lesson.lesson_id) }}">
                <button type="submit" class="neo-button accent">‚úÖ –ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
            </form>
            <a href="{{ url_for('student_profile', student_id=active_student.student_id) }}" class="neo-button ghost">üë§ –ü—Ä–æ—Ñ–∏–ª—å</a>
        </div>
    </div>
    <script>
        function toggleLessonMenu() {
            const menu = document.getElementById('lessonMenu');
            if (menu) {
                menu.classList.toggle('active');
            }
        }
        document.addEventListener('click', (event) => {
            const menu = document.getElementById('lessonMenu');
            const badge = document.querySelector('.now-playing-pill');
            if (!menu || !badge) return;
            if (!menu.contains(event.target) && !badge.contains(event.target)) {
                menu.classList.remove('active');
            }
        });
    </script>
    {% endif %}

    <div class="app-shell">
        <header class="nav-primary">
            <div class="nav-brand">
                <a href="{{ url_for('index') }}" style="text-decoration: none; display: flex; align-items: center; gap: 1rem; color: inherit;">
                    <div class="brand-mark">LOGO</div>
                    <div class="brand-caption">–°–ª–æ—Ç –ø–æ–¥ —Ñ–∏—Ä–º–µ–Ω–Ω—ã–π –∑–Ω–∞–∫</div>
                </a>
            </div>
            {% include '_mobile_menu.html' %}
            <nav class="nav-links"> <!-- –ë–ª–æ–∫ —Å—Å—ã–ª–æ–∫ –≤–µ—Ä—Ö–Ω–µ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
                <a href="{{ url_for('dashboard') }}" class="nav-link active"> <!-- –°—Å—ã–ª–∫–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —É—á–µ–Ω–∏–∫–æ–≤ -->
                    <span class="nav-link-content"> <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∏–∫–æ–Ω–∫–∏ –∏ –ø–æ–¥–ø–∏—Å–∏ -->
                        <img src="{{ url_for('static', filename='icons/students_white-no-bg-preview (carve.photos).png') }}" alt="–ò–∫–æ–Ω–∫–∞ —Ä–∞–∑–¥–µ–ª–∞ –£—á–µ–Ω–∏–∫–∏" class="nav-link-icon"> <!-- –ò–∫–æ–Ω–∫–∞ —Ä–∞–∑–¥–µ–ª–∞ –£—á–µ–Ω–∏–∫–∏ -->
                        <span class="nav-link-label">–£—á–µ–Ω–∏–∫–∏</span> <!-- –ü–æ–¥–ø–∏—Å—å —Å—Å—ã–ª–∫–∏ –£—á–µ–Ω–∏–∫–∏ -->
                    </span>
                </a>
                <a href="{{ url_for('schedule') }}" class="nav-link"> <!-- –°—Å—ã–ª–∫–∞ –Ω–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ -->
                    <span class="nav-link-content"> <!-- –û–±–µ—Ä—Ç–∫–∞ –¥–ª—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è -->
                        <img src="{{ url_for('static', filename='icons/schedule_white.png') }}" alt="–ò–∫–æ–Ω–∫–∞ —Ä–∞–∑–¥–µ–ª–∞ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ" class="nav-link-icon"> <!-- –ò–∫–æ–Ω–∫–∞ —Ä–∞–∑–¥–µ–ª–∞ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ -->
                        <span class="nav-link-label">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</span> <!-- –ü–æ–¥–ø–∏—Å—å —Å—Å—ã–ª–∫–∏ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ -->
                    </span>
                </a>
                <a href="{{ url_for('kege_generator') }}" class="nav-link"> <!-- –°—Å—ã–ª–∫–∞ –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä -->
                    <span class="nav-link-content"> <!-- –û–±–µ—Ä—Ç–∫–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ -->
                        <img src="{{ url_for('static', filename='icons/generator_white-no-bg-preview (carve.photos).png') }}" alt="–ò–∫–æ–Ω–∫–∞ —Ä–∞–∑–¥–µ–ª–∞ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä" class="nav-link-icon"> <!-- –ò–∫–æ–Ω–∫–∞ —Ä–∞–∑–¥–µ–ª–∞ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä -->
                        <span class="nav-link-label">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä</span> <!-- –ü–æ–¥–ø–∏—Å—å —Å—Å—ã–ª–∫–∏ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä -->
                    </span>
                </a>
                <a href="{{ url_for('update_plans') }}" class="nav-link"> <!-- –°—Å—ã–ª–∫–∞ –Ω–∞ –ø–ª–∞–Ω—ã -->
                    <span class="nav-link-content"> <!-- –û–±–µ—Ä—Ç–∫–∞ –¥–ª—è –ø–ª–∞–Ω–æ–≤ -->
                        <img src="{{ url_for('static', filename='icons/notes_white-no-bg-preview (carve.photos).png') }}" alt="–ò–∫–æ–Ω–∫–∞ —Ä–∞–∑–¥–µ–ª–∞ –ü–ª–∞–Ω—ã" class="nav-link-icon"> <!-- –ò–∫–æ–Ω–∫–∞ —Ä–∞–∑–¥–µ–ª–∞ –ü–ª–∞–Ω—ã -->
                        <span class="nav-link-label">–ü–ª–∞–Ω—ã</span> <!-- –ü–æ–¥–ø–∏—Å—å —Å—Å—ã–ª–∫–∏ –ü–ª–∞–Ω—ã -->
                    </span>
                </a>
            </nav>
            <div class="nav-actions">
                <div class="brand-caption icon-slot"> <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏–∫–æ–Ω–∫–∏ —Ä–∞–∑–¥–µ–ª–∞ –£—á–µ–Ω–∏–∫–∏ -->
                    <img src="{{ url_for('static', filename='icons/students_white-no-bg-preview (carve.photos).png') }}" alt="–ò–∫–æ–Ω–∫–∞ —Ä–∞–∑–¥–µ–ª–∞ –£—á–µ–Ω–∏–∫–∏" class="brand-icon brand-icon--students"> <!-- –ë–µ–ª–∞—è –∏–∫–æ–Ω–∫–∞ —É—á–µ–Ω–∏–∫–æ–≤ —É–≤–µ–ª–∏—á–µ–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ -->
                </div>
            </div>
        </header>

        <section class="dashboard-hero glass-panel">
            <div>
                <p class="hero-eyebrow">–ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</p>
                <h1 class="hero-title">–ß—ë—Ä–Ω—ã–π –Ω–µ–æ–Ω. –ù–æ–≤—ã–π –≤–∑–≥–ª—è–¥ –Ω–∞ —É—á—ë–±—É.</h1>
                <p class="hero-subtitle">
                    –£–ø—Ä–∞–≤–ª—è–π —É—á–µ–Ω–∏–∫–∞–º–∏, —É—Ä–æ–∫–∞–º–∏ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º –≤ –µ–¥–∏–Ω–æ–º –Ω–µ–æ–Ω–æ–≤–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ. –õ–∞–∫–æ–Ω–∏—á–Ω–æ, –±—ã—Å—Ç—Ä–æ
                    –∏ —Å –≤–∏–∑—É–∞–ª—å–Ω—ã–º–∏ –∞–∫—Ü–µ–Ω—Ç–∞–º–∏ –Ω–∞ —Ç–æ, —á—Ç–æ –≤–∞–∂–Ω–æ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å.
                </p>
                <div class="hero-actions">
                    <a href="{{ url_for('export_data') }}" class="neo-button accent">üì§ –≠–∫—Å–ø–æ—Ä—Ç</a>
                    <a href="{{ url_for('import_data') }}" class="neo-button outline">üì• –ò–º–ø–æ—Ä—Ç</a>
                    <a href="{{ url_for('backup_db') }}" class="neo-button ghost">üíæ –ë—ç–∫–∞–ø –ë–î</a>
                </div>
            </div>
            <div class="hero-pane">
                <div class="hero-metric">
                    <div class="hero-metric-label">–∞–∫—Ç–∏–≤–Ω—ã–µ —É—á–µ–Ω–∏–∫–∏</div>
                    <div class="hero-metric-value">{{ total_students }}</div>
                </div>
                <div class="hero-metric">
                    <div class="hero-metric-label">–∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ —É—Ä–æ–∫–æ–≤</div>
                    <div class="hero-metric-value">{{ planned_lessons }}</div>
                </div>
                <div class="hero-metric">
                    <div class="hero-metric-label">–ø—Ä–æ–≤–µ–¥–µ–Ω–æ —É—Ä–æ–∫–æ–≤</div>
                    <div class="hero-metric-value">{{ completed_lessons }}</div>
                </div>
            </div>
        </section>

        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="alert alert-{{ category }}">{{ message }}</div>
            {% endfor %}
          {% endif %}
        {% endwith %}

        <section class="glass-panel filters-panel">
            <form method="GET" action="{{ url_for('dashboard') }}" class="filters-grid">
                <input type="hidden" name="show_archive" value="{{ 'true' if show_archive else 'false' }}">
                <div class="neo-field">
                    <label class="neo-label">–ü–æ–∏—Å–∫</label>
                    <input type="text" name="search" value="{{ search_query }}" class="neo-input" placeholder="–ò–º—è –∏–ª–∏ ID —É—á–µ–Ω–∏–∫–∞">
                </div>
                <div class="neo-field">
                    <label class="neo-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <select name="category" class="neo-select">
                        <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                        <option value="–ï–ì–≠" {% if category_filter == '–ï–ì–≠' %}selected{% endif %}>–ï–ì–≠</option>
                        <option value="–û–ì–≠" {% if category_filter == '–û–ì–≠' %}selected{% endif %}>–û–ì–≠</option>
                        <option value="–õ–ï–í–ï–õ–ê–ü" {% if category_filter == '–õ–ï–í–ï–õ–ê–ü' %}selected{% endif %}>–õ–ï–í–ï–õ–ê–ü</option> <!-- –§–∏–ª—å—Ç—Ä –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é –õ–ï–í–ï–õ–ê–ü -->
                        <option value="–ü–†–û–ì–†–ê–ú–ú–ò–†–û–í–ê–ù–ò–ï" {% if category_filter == '–ü–†–û–ì–†–ê–ú–ú–ò–†–û–í–ê–ù–ò–ï' %}selected{% endif %}>–ü–†–û–ì–†–ê–ú–ú–ò–†–û–í–ê–ù–ò–ï</option> <!-- –§–∏–ª—å—Ç—Ä –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è -->
                    </select>
                </div>
                <div class="filters-actions">
                    <button type="submit" class="neo-button accent">üîç –ù–∞–π—Ç–∏</button>
                    {% if search_query or category_filter %}
                    <a href="{{ url_for('dashboard', show_archive='true' if show_archive else 'false') }}" class="neo-button ghost">‚ü≤ –°–±—Ä–æ—Å–∏—Ç—å</a>
                    {% endif %}
                </div>
            </form>
            <div style="margin-top: 1rem; display: flex; gap: 0.5rem; align-items: center;">
                <a href="{{ url_for('dashboard', show_archive='false', search=search_query, category=category_filter) }}" 
                   class="neo-button {% if not show_archive %}accent{% else %}ghost{% endif %}" 
                   style="text-decoration: none;">
                    üë• –ê–∫—Ç–∏–≤–Ω—ã–µ ({{ total_students }})
                </a>
                <a href="{{ url_for('dashboard', show_archive='true', search=search_query, category=category_filter) }}" 
                   class="neo-button {% if show_archive %}accent{% else %}ghost{% endif %}" 
                   style="text-decoration: none;">
                    üì¶ –ê—Ä—Ö–∏–≤ ({{ archived_students_count }})
                </a>
            </div>
        </section>

        <section class="stats-grid">
            <article class="stat-card">
                <strong>{{ students|length }}</strong>
                <span>–ù–ê –≠–ö–†–ê–ù–ï</span>
            </article>
            <article class="stat-card">
                <strong>{{ total_students }}</strong>
                <span>–ê–ö–¢–ò–í–ù–´–•</span>
            </article>
            <article class="stat-card">
                <strong>{{ total_lessons }}</strong>
                <span>–í–°–ï–ì–û –£–†–û–ö–û–í</span>
            </article>
            <article class="stat-card">
                <strong>{{ planned_lessons }}</strong>
                <span>–ó–ê–ü–õ–ê–ù–ò–†–û–í–ê–ù–û</span>
            </article>
            <article class="stat-card">
                <strong>{{ completed_lessons }}</strong>
                <span>–ü–†–û–í–ï–î–ï–ù–û</span>
            </article>
            {% if not category_filter %}
            <article class="stat-card">
                <strong>{{ ege_students }}</strong>
                <span>–ï–ì–≠</span>
            </article>
            <article class="stat-card">
                <strong>{{ oge_students }}</strong>
                <span>–û–ì–≠</span>
            </article>
            <article class="stat-card">
                <strong>{{ levelup_students }}</strong>
                <span>–õ–ï–í–ï–õ–ê–ü</span>
            </article>
            <article class="stat-card"> <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è -->
                <strong>{{ programming_students }}</strong> <!-- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–µ–Ω–∏–∫–æ–≤ –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é -->
                <span>–ü–†–û–ì–†–ê–ú–ú–ò–†–û–í–ê–ù–ò–ï</span> <!-- –ü–æ–¥–ø–∏—Å—å –∫–∞—Ä—Ç–æ—á–∫–∏ -->
            </article>
            {% endif %}
        </section>

        <section class="glass-panel students-panel">
            <div class="panel-head">
                <div>
                    <p class="eyebrow">{% if show_archive %}–∞—Ä—Ö–∏–≤–Ω—ã–µ —É—á–µ–Ω–∏–∫–∏{% else %}–∞–∫—Ç–∏–≤–Ω—ã–µ —É—á–µ–Ω–∏–∫–∏{% endif %}</p>
                    <h2>{{ students|length }} –≤ –ø–æ–¥–±–æ—Ä–∫–µ</h2>
                </div>
                <div class="hero-actions">
                    {% if not show_archive %}
                    <a href="{{ url_for('student_new') }}" class="neo-button accent">+ –î–æ–±–∞–≤–∏—Ç—å</a>
                    {% endif %}
                </div>
            </div>

            {% if students %}
            <div class="students-grid">
                {% if not show_archive %}
                <a href="{{ url_for('student_new') }}" class="student-card student-card--cta">
                    <div class="hero-eyebrow">quick action</div>
                    <h3 style="margin: 0;">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ —É—á–µ–Ω–∏–∫–∞</h3>
                    <p class="hero-subtitle">–°—Ç–∞—Ä—Ç–æ–≤–∞—è —Ç–æ—á–∫–∞ –¥–ª—è —Ü–µ–ª–µ–π, —É—Ä–æ–∫–æ–≤ –∏ –∑–∞–º–µ—Ç–æ–∫.</p>
                </a>
                {% endif %}
                {% for student in students %}
                <a href="{{ url_for('student_profile', student_id=student.student_id) }}"
                   class="student-card {% if active_student and student.student_id == active_student.student_id %}active-student{% endif %} {% if show_archive %}student-card--archived{% endif %}"
                   data-student-id="{{ student.student_id }}">
                    <div class="student-card__head">
                        <div class="student-avatar {% if show_archive %}student-avatar--archived{% endif %}">{{ student.name[0].upper() }}</div>
                        <div>
                            <p class="student-name">{{ student.name }}{% if show_archive %} <span style="opacity: 0.6; font-size: 0.85em;">(–∞—Ä—Ö–∏–≤)</span>{% endif %}</p>
                            {% if student.platform_id %}
                            <p class="student-meta student-platform-id">ID: {{ student.platform_id }}</p>
                            {% endif %}
                        </div>
                    </div>
                    {% if student.category %}
                    <span class="student-tag student-category">{{ student.category }}</span>
                    {% endif %}
                    {% if student.school_class %}
                    <span class="student-tag student-class">{{ student.school_class }} –∫–ª–∞—Å—Å</span> {# –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∫–ª–∞—Å—Å —É—á–µ–Ω–∏–∫–∞ –ø—Ä—è–º–æ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ #}
                    {% endif %}
                    {% if student.description %}
                    <p class="hero-subtitle" style="font-size: 0.9rem;">
                        "{{ student.description[:130] }}{% if student.description|length > 130 %}‚Ä¶{% endif %}"
                    </p>
                    {% endif %}
                    <div class="student-insights">
                        {% if student.category == '–ü–†–û–ì–†–ê–ú–ú–ò–†–û–í–ê–ù–ò–ï' and student.goal_text %}
                        <div>üéØ –¶–µ–ª—å: {{ student.goal_text }}</div> <!-- –¢–µ–∫—Å—Ç–æ–≤–∞—è —Ü–µ–ª—å –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è -->
                        {% elif student.category == '–õ–ï–í–ï–õ–ê–ü' and student.goal_text %}
                        <div>üéØ –¶–µ–ª—å: {{ student.goal_text }}</div> <!-- –¢–µ–∫—Å—Ç–æ–≤–∞—è —Ü–µ–ª—å –¥–ª—è –õ–ï–í–ï–õ–ê–ü -->
                        {% elif student.target_score %}
                        <div>üéØ {% if student.category == '–û–ì–≠' %}–¶–µ–ª–µ–≤–∞—è –æ—Ü–µ–Ω–∫–∞{% else %}–¶–µ–ª—å{% endif %}: {{ student.target_score }}{% if student.category != '–û–ì–≠' %} –±–∞–ª–ª–æ–≤{% endif %}</div> <!-- –ß–∏—Å–ª–æ–≤–∞—è —Ü–µ–ª—å -->
                        {% endif %}
                        {% if student.category != '–ü–†–û–ì–†–ê–ú–ú–ò–†–û–í–ê–ù–ò–ï' and student.deadline %}
                        <div>‚è∞ –°—Ä–æ–∫: {{ student.deadline }}</div> <!-- –°—Ä–æ–∫ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏ -->
                        {% endif %}
                        {% if student.school_class %}
                        <div>üè´ –ö–ª–∞—Å—Å: {{ student.school_class }}</div> {# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –∫–ª–∞—Å—Å–µ #}
                        {% endif %}
                        {% if student.category == '–ü–†–û–ì–†–ê–ú–ú–ò–†–û–í–ê–ù–ò–ï' and student.programming_language %}
                        <div>üíª –Ø–∑—ã–∫: {{ student.programming_language }}</div> <!-- –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º—ã–π —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è -->
                        {% endif %}
                        {% if student.diagnostic_level %}
                        <div>üìä –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞: <span>{{ student.diagnostic_level }}</span></div>
                        {% endif %}
                        {% if student.overall_rating %}
                        <div>‚≠ê –û—Ü–µ–Ω–∫–∞: <span>{{ student.overall_rating }}</span></div>
                        {% endif %}
                        {% if student.strengths %}
                        <div>üí™ –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã: <span>{{ student.strengths[:60] }}{% if student.strengths|length > 60 %}‚Ä¶{% endif %}</span></div>
                        {% endif %}
                        {% if student.weaknesses %}
                        <div>üß© –ó–æ–Ω—ã —Ä–æ—Å—Ç–∞: <span>{{ student.weaknesses[:60] }}{% if student.weaknesses|length > 60 %}‚Ä¶{% endif %}</span></div>
                        {% endif %}
                    </div>
                </a>
                {% endfor %}
            </div>

            {% if pagination.pages > 1 %}
            <div class="pagination">
                {% if pagination.has_prev %}
                <a href="{{ url_for('dashboard', page=pagination.prev_num, search=search_query, category=category_filter, show_archive='true' if show_archive else 'false') }}" class="pagination-btn">‚Äπ –ù–∞–∑–∞–¥</a>
                {% else %}
                <span class="pagination-btn disabled">‚Äπ –ù–∞–∑–∞–¥</span>
                {% endif %}
                <span>–°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ pagination.page }} –∏–∑ {{ pagination.pages }}</span>
                {% if pagination.has_next %}
                <a href="{{ url_for('dashboard', page=pagination.next_num, search=search_query, category=category_filter, show_archive='true' if show_archive else 'false') }}" class="pagination-btn">–í–ø–µ—Ä—ë–¥ ‚Ä∫</a>
                {% else %}
                <span class="pagination-btn disabled">–í–ø–µ—Ä—ë–¥ ‚Ä∫</span>
                {% endif %}
            </div>
            {% endif %}
            {% else %}
            <div class="empty-state">
                <div style="font-size: 3rem; margin-bottom: 0.6rem;">{% if show_archive %}üì¶{% else %}üë•{% endif %}</div>
                <h3>{% if show_archive %}–ê—Ä—Ö–∏–≤ –ø—É—Å—Ç{% else %}–ü–æ–∫–∞ –Ω–µ—Ç —É—á–µ–Ω–∏–∫–æ–≤{% endif %}</h3>
                <p style="color: var(--text-muted);">{% if show_archive %}–í –∞—Ä—Ö–∏–≤–µ –ø–æ–∫–∞ –Ω–µ—Ç —É—á–µ–Ω–∏–∫–æ–≤{% else %}–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤–æ–≥–æ —É—á–µ–Ω–∏–∫–∞, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É{% endif %}</p>
                {% if not show_archive %}
                <a href="{{ url_for('student_new') }}" class="neo-button accent" style="margin-top: 1rem;">–î–æ–±–∞–≤–∏—Ç—å</a>
                {% endif %}
            </div>
            {% endif %}
        </section>
    </div>

    <script src="{{ url_for('static', filename='ajax-utils.js') }}"></script>
    <script src="{{ url_for('static', filename='toast.js') }}"></script>
    <script src="{{ url_for('static', filename='loading.js') }}"></script>
    <script src="{{ url_for('static', filename='dashboard-ajax.js') }}"></script>
    <script src="{{ url_for('static', filename='audit-tracker.js') }}"></script>
</body>
</html>