# Как установить команду запуска для бота в Railway

## Проблема

Railway блокирует поле "Start Command" в UI, потому что находит `railway.json` в корне проекта с командой для веб-приложения (`gunicorn wsgi:app...`).

## Решение 1: Удалить railway.json из корня (если возможно)

Если веб-приложение может работать без `railway.json` (используя Procfile):

1. Удалите `railway.json` из корня проекта
2. Установите команды запуска вручную для каждого сервиса через UI:
   - Для веб-сервиса: `gunicorn wsgi:app --bind 0.0.0.0:$PORT --workers 2 --threads 2 --timeout 120`
   - Для бота: `python telegram_bot/run_bot.py`

**⚠️ ВНИМАНИЕ:** Это может сломать веб-приложение, если оно зависит от `railway.json`.

## Решение 2: Использовать Railway CLI (рекомендуется)

Установите команду запуска через Railway CLI:

```bash
# 1. Установите Railway CLI (если еще не установлен)
npm i -g @railway/cli

# 2. Войдите в Railway
railway login

# 3. Выберите проект
railway link

# 4. Выберите сервис бота (через UI или через переменную окружения)
# В Railway Dashboard выберите сервис "telegram-bot"

# 5. Установите команду запуска через переменную окружения
railway variables set RAILWAY_START_COMMAND="python telegram_bot/run_bot.py"
```

Или через Railway Dashboard:
1. Settings → Variables
2. Добавьте переменную: `RAILWAY_START_COMMAND` = `python telegram_bot/run_bot.py`

## Решение 3: Переименовать railway.json для веб-сервиса

1. Переименуйте `railway.json` в `railway-web.json`
2. В настройках веб-сервиса в Railway укажите путь к конфигу (если поддерживается)
3. Для сервиса бота установите команду вручную

**⚠️ Это может не сработать**, так как Railway ищет `railway.json` в корне.

## Решение 4: Использовать Procfile (самое простое)

Railway автоматически использует `Procfile`, если он есть, даже если есть `railway.json`.

1. Убедитесь, что в корне есть `Procfile` с командой для веб-приложения:
   ```
   web: gunicorn wsgi:app --bind 0.0.0.0:$PORT --workers 2 --threads 2 --timeout 120
   ```

2. Удалите `railway.json` из корня (или переименуйте его)

3. Для сервиса бота создайте отдельный `Procfile` в директории `telegram_bot/`:
   ```
   bot: python telegram_bot/run_bot.py
   ```

4. В настройках сервиса бота в Railway:
   - Settings → Deploy → Root Directory: установите `/telegram_bot` (если поддерживается)
   - Или установите команду вручную через UI (теперь поле должно быть доступно)

## Решение 5: Временное переименование (быстрое решение)

1. Временно переименуйте `railway.json` в `railway.json.backup`
2. Закоммитьте и запушьте изменения
3. В Railway Dashboard для сервиса бота установите команду через UI (поле должно стать доступным)
4. Верните `railway.json` обратно
5. Для веб-сервиса установите команду вручную через UI

## Проверка

После установки команды:

1. Проверьте логи в Railway Dashboard → сервис бота → Deployments → последний деплой
2. Должна появиться строка: `Бот запущен и готов к работе`
3. Отправьте `/start` боту в личке - должен ответить

## Рекомендация

**Используйте Решение 4 (Procfile)** - это самый простой и надежный способ:
- Railway хорошо поддерживает Procfile
- Можно иметь разные команды для разных сервисов
- Не нужно удалять `railway.json` (можно оставить как резерв)