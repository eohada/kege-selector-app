# Как установить команду запуска через UI в Railway

## Пошаговая инструкция

### Для веб-сервиса:

1. **Откройте Railway Dashboard**
   - Перейдите на https://railway.app
   - Войдите в аккаунт

2. **Выберите ваш проект**
   - В списке проектов найдите нужный проект
   - Кликните на него

3. **Вернитесь к обзору проекта и выберите веб-сервис**
   - Если вы сейчас внутри сервиса `telegram-bot`, вернитесь к обзору проекта:
     - Кликните на **иконку сетки** (9 квадратов) в левой панели
     - Или кликните на **название проекта** в верхней навигационной панели
   - В обзоре проекта найдите ваш веб-сервис (может называться `web`, `kege-selector-app` или как-то иначе)
   - **Кликните на карточку веб-сервиса**
   
   **Подробнее:** см. `HOW_TO_FIND_WEB_SERVICE.md`

4. **Откройте настройки Deploy**
   - В верхней панели найдите вкладку **"Settings"**
   - Кликните на **"Settings"**
   - В левом меню найдите раздел **"Deploy"**
   - Кликните на **"Deploy"**

5. **Найдите поле "Start Command"**
   - Прокрутите страницу вниз до секции **"Custom Start Command"**
   - Если поле заблокировано (серое) и показывает "The value is set in railway.json":
     - Это значит, что `railway.json` все еще существует в репозитории
     - Нужно сначала удалить/переименовать `railway.json` и запушить изменения
   - Если поле доступно (белое, можно редактировать):
     - Кликните в поле ввода
     - Введите команду: `gunicorn wsgi:app --bind 0.0.0.0:$PORT --workers 2 --threads 2 --timeout 120`
     - Нажмите **"Save"** или **"Update"** (кнопка обычно внизу страницы)

6. **Проверьте, что команда сохранилась**
   - После сохранения поле должно показать введенную команду
   - Railway автоматически перезапустит сервис с новой командой

### Для сервиса бота (telegram-bot):

1. **Выберите сервис telegram-bot**
   - В списке сервисов найдите сервис `telegram-bot`
   - Кликните на него

2. **Откройте настройки Deploy**
   - Settings → Deploy

3. **Установите команду запуска**
   - В поле **"Custom Start Command"** введите: `python telegram_bot/run_bot.py`
   - Нажмите **"Save"**

## Если поле "Start Command" заблокировано

Если поле показывает "The value is set in railway.json" и заблокировано:

1. **Проверьте, что railway.json удален/переименован в репозитории**
   - Убедитесь, что изменения запушены в GitHub
   - Railway должен автоматически подхватить изменения

2. **Подождите несколько секунд**
   - Railway может кэшировать конфигурацию
   - Обновите страницу (F5)

3. **Если все еще заблокировано:**
   - Попробуйте использовать **Root Directory** (см. RAILWAY_FIX_START_COMMAND.md)
   - Или используйте Railway CLI для установки команды

## Альтернатива: Через Railway CLI

Если UI не работает, можно использовать CLI:

```bash
# 1. Установите Railway CLI (если еще не установлен)
npm i -g @railway/cli

# 2. Войдите в Railway
railway login

# 3. Выберите проект
railway link

# 4. Для веб-сервиса (выберите его в UI или через команду)
railway service
# Выберите веб-сервис из списка

# 5. Установите команду запуска
railway variables set RAILWAY_START_COMMAND="gunicorn wsgi:app --bind 0.0.0.0:\$PORT --workers 2 --threads 2 --timeout 120"
```

**Примечание:** В CLI нужно экранировать `$PORT` как `\$PORT`.

## Проверка

После установки команд:

1. **Проверьте логи веб-сервиса:**
   - Должны появиться логи gunicorn: `Starting gunicorn...`

2. **Проверьте логи сервиса бота:**
   - Должна появиться строка: `Бот запущен и готов к работе`

3. **Убедитесь, что оба сервиса работают:**
   - Веб-сервис должен отвечать на HTTP-запросы
   - Бот должен отвечать на команду `/start` в Telegram