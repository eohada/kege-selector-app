# –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö

## –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –±–∞–∑—ã –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–°–ê–ú–´–ô –ü–†–û–°–¢–û–ô!)

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à —Å–µ—Ä–≤–∏—Å –≤ –±—Ä–∞—É–∑–µ—Ä–µ:**
   - Production: `https://–≤–∞—à-production.up.railway.app/admin/diagnostics/db-check`
   - Sandbox: `https://–≤–∞—à-sandbox.up.railway.app/admin/diagnostics/db-check`
   - Admin: `https://–≤–∞—à-admin.up.railway.app/admin/diagnostics/db-check`

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å JSON —Å `"status": "success"` –∏ `"connection_status": "OK"`
   - –ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫—É - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ `DATABASE_URL` –≤ Variables

**–ü—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "status": "success",
  "environment": "sandbox",
  "database": {
    "connection_status": "OK",
    "tables_count": 24,
    "important_tables": {
      "Users": 5,
      "Students": 10,
      "Lessons": 3,
      "Tasks": 150
    }
  }
}
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ Railway Shell (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)

1. **–û—Ç–∫—Ä–æ–π—Ç–µ Railway Shell –≤ –ª—é–±–æ–º —Å–µ—Ä–≤–∏—Å–µ:**
   - Production/Sandbox/Admin —Å–µ—Ä–≤–∏—Å ‚Üí Settings ‚Üí Shell ‚Üí Open Shell

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:**
   ```bash
   python scripts/verify_railway_databases.py
   ```

3. **–ß—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
   ```
   üåç –û–∫—Ä—É–∂–µ–Ω–∏–µ: PRODUCTION (–∏–ª–∏ SANDBOX, –∏–ª–∏ ADMIN)
   üìä –ü—Ä–æ–≤–µ—Ä—è–µ–º: Production DB (PRODUCTION)
   ‚úÖ Production DB (PRODUCTION): –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ
   ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!
   ```

   **–í–∞–∂–Ω–æ:** –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–µ–∫—É—â—É—é –±–∞–∑—É (—á–µ—Ä–µ–∑ `DATABASE_URL`). 
   –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Å–µ—Ö –±–∞–∑ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –≤ –∫–∞–∂–¥–æ–º —Å–µ—Ä–≤–∏—Å–µ –æ—Ç–¥–µ–ª—å–Ω–æ.

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ –ª–æ–≥–∏ –¥–µ–ø–ª–æ—è

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –∫–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å:**
   - Production ‚Üí Deployments ‚Üí –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–ª–æ–π ‚Üí View Logs
   - Sandbox ‚Üí Deployments ‚Üí –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–ª–æ–π ‚Üí View Logs
   - Admin ‚Üí Deployments ‚Üí –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–ª–æ–π ‚Üí View Logs

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –Ω–µ—Ç –ª–∏ –æ—à–∏–±–æ–∫:**
   - ‚ùå `Database connection failed` - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π DATABASE_URL
   - ‚ùå `Table does not exist` - —Ç–∞–±–ª–∏—Ü—ã –Ω–µ —Å–æ–∑–¥–∞–Ω—ã (–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞—Å—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
   - ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ - –≤—Å–µ —Ö–æ—Ä–æ—à–æ

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ß–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
   - Production: `https://–≤–∞—à-production.up.railway.app`
   - Sandbox: `https://–≤–∞—à-sandbox.up.railway.app`
   - Admin: `https://–≤–∞—à-admin.up.railway.app/remote-admin`

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
   - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫ 500
   - –î–∞–Ω–Ω—ã–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è (–µ—Å–ª–∏ –ø–µ—Ä–µ–Ω–æ—Å–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ)
   - –ú–æ–∂–Ω–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É

## –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –±–∞–∑—ã –ø—É—Å—Ç—ã–µ

### –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ!

–ù–æ–≤—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç—ã–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ.

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü

1. **–û—Ç–∫—Ä–æ–π—Ç–µ Railway Shell –≤ –Ω—É–∂–Ω–æ–º —Å–µ—Ä–≤–∏—Å–µ**

2. **–°–æ–∑–¥–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—ã –≤—Ä—É—á–Ω—É—é (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):**
   ```bash
   python -c "from app import create_app, db; app = create_app(); app.app_context().push(); db.create_all(); print('‚úÖ –¢–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã')"
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã:**
   ```bash
   python scripts/verify_railway_databases.py
   ```
   
   –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å: `‚úÖ –ù–∞–π–¥–µ–Ω–æ —Ç–∞–±–ª–∏—Ü: X`

## –ö–∞–∫ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å—Ç–∞—Ä—ã—Ö –±–∞–∑

### –®–∞–≥ 1: –ù–∞–π–¥–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ –±–∞–∑—ã

1. **–°—Ç–∞—Ä–∞—è Production –±–∞–∑–∞:**
   - –ù–∞–π–¥–∏—Ç–µ —Å—Ç–∞—Ä—ã–π Production —Å–µ—Ä–≤–∏—Å –≤ Railway
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `DATABASE_URL` –∏–∑ Variables

2. **–°—Ç–∞—Ä–∞—è Sandbox –±–∞–∑–∞:**
   - –ù–∞–π–¥–∏—Ç–µ —Å—Ç–∞—Ä—ã–π Sandbox —Å–µ—Ä–≤–∏—Å –≤ Railway
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `DATABASE_URL` –∏–∑ Variables

### –®–∞–≥ 2: –ù–∞–π–¥–∏—Ç–µ –Ω–æ–≤—ã–µ –±–∞–∑—ã

1. **–ù–æ–≤–∞—è Production –±–∞–∑–∞:**
   - –ü—Ä–æ–µ–∫—Ç "Databases" ‚Üí "production-db" ‚Üí Variables ‚Üí `DATABASE_URL`

2. **–ù–æ–≤–∞—è Sandbox –±–∞–∑–∞:**
   - –ü—Ä–æ–µ–∫—Ç "Databases" ‚Üí "sandbox-db" ‚Üí Variables ‚Üí `DATABASE_URL`

### –®–∞–≥ 3: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é

1. **–û—Ç–∫—Ä–æ–π—Ç–µ Railway Shell –≤ Production —Å–µ—Ä–≤–∏—Å–µ**

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
   ```bash
   export OLD_PRODUCTION_DATABASE_URL="postgresql://—Å—Ç–∞—Ä–∞—è_–±–∞–∑–∞"
   export NEW_PRODUCTION_DATABASE_URL="postgresql://–Ω–æ–≤–∞—è_–±–∞–∑–∞_production-db"
   ```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é:**
   ```bash
   python scripts/migrate_to_centralized_db.py production
   ```

4. **–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –¥–ª—è Sandbox:**
   ```bash
   export OLD_SANDBOX_DATABASE_URL="postgresql://—Å—Ç–∞—Ä–∞—è_–±–∞–∑–∞"
   export NEW_SANDBOX_DATABASE_URL="postgresql://–Ω–æ–≤–∞—è_–±–∞–∑–∞_sandbox-db"
   python scripts/migrate_to_centralized_db.py sandbox
   ```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –º–∏–≥—Ä–∞—Ü–∏–∏:**
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `‚úÖ –ü–µ—Ä–µ–Ω–æ—Å –∑–∞–≤–µ—Ä—à–µ–Ω! –í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π: X`

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ Production/Sandbox –≤ –±—Ä–∞—É–∑–µ—Ä–µ
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

## –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### ‚ùå "URL –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `DATABASE_URL` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤ —Å–µ—Ä–≤–∏—Å–µ.

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–µ—Ä–≤–∏—Å –≤ Railway
2. Variables ‚Üí –Ω–∞–π–¥–∏—Ç–µ –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ `DATABASE_URL`
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –ë–î (production-db/sandbox-db/admin-db)

### ‚ùå "–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `DATABASE_URL` –∏–ª–∏ –ë–î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ë–î —Ä–∞–±–æ—Ç–∞–µ—Ç (–∑–µ–ª–µ–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤ Railway)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `DATABASE_URL` –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π (—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∑–∞–Ω–æ–≤–æ –∏–∑ –ë–î)
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL (–Ω–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π Railway URL –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è)

### ‚ùå "–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–∞"

**–ü—Ä–∏—á–∏–Ω–∞:** –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –Ω–æ–≤—ã—Ö –±–∞–∑.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞—Å—Ç —Ç–∞–±–ª–∏—Ü—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
2. –ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ Shell (—Å–º. –≤—ã—à–µ)
3. –ò–ª–∏ –ø–µ—Ä–µ–Ω–µ—Å–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å—Ç–∞—Ä—ã—Ö –±–∞–∑ (—Å–º. –≤—ã—à–µ)

### ‚ùå "Table does not exist"

**–ü—Ä–∏—á–∏–Ω–∞:** –¢–∞–±–ª–∏—Ü—ã –Ω–µ —Å–æ–∑–¥–∞–Ω—ã –≤ –±–∞–∑–µ.

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ Railway Shell
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ: `python -c "from app import create_app, db; app = create_app(); app.app_context().push(); db.create_all()"`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –±–∞–∑–µ

```bash
python -c "
from sqlalchemy import create_engine, text
import os
url = os.environ.get('DATABASE_URL')
if url.startswith('postgres://'):
    url = url.replace('postgres://', 'postgresql://', 1)
engine = create_engine(url)
with engine.connect() as conn:
    result = conn.execute(text('SELECT 1'))
    print('‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ')
"
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–∞–±–ª–∏—Ü

```bash
python -c "
from sqlalchemy import create_engine, inspect
import os
url = os.environ.get('DATABASE_URL')
if url.startswith('postgres://'):
    url = url.replace('postgres://', 'postgresql://', 1)
engine = create_engine(url)
inspector = inspect(engine)
tables = inspector.get_table_names()
print(f'–ù–∞–π–¥–µ–Ω–æ —Ç–∞–±–ª–∏—Ü: {len(tables)}')
for table in tables:
    print(f'  - {table}')
"
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü–µ

```bash
python -c "
from sqlalchemy import create_engine, text
import os
url = os.environ.get('DATABASE_URL')
if url.startswith('postgres://'):
    url = url.replace('postgres://', 'postgresql://', 1)
engine = create_engine(url)
with engine.connect() as conn:
    result = conn.execute(text('SELECT COUNT(*) FROM \"Users\"'))
    count = result.fetchone()[0]
    print(f'–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {count}')
"
```
