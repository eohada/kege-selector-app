# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —É—Ä–æ–∫–æ–≤ –∏–∑ –ø–µ—Å–æ—á–Ω–∏—Ü—ã –≤ –ø—Ä–æ–¥

## –û–ø–∏—Å–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç `scripts/sync_lessons_sandbox_to_prod.py` –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ–± —É—Ä–æ–∫–∞—Ö, –¥–æ–º–∞—à–Ω–∏—Ö –∏ –∫–ª–∞—Å—Å–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞—Ö –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø–µ—Å–æ—á–Ω–∏—Ü—ã –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞.

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —É—Ä–æ–∫–∏ –ø–æ –¥–∞—Ç–µ, –≤—Ä–µ–º–µ–Ω–∏ –∏ —É—á–µ–Ω–∏–∫—É
- ‚úÖ –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç —É—Ä–æ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –≤ –ø—Ä–æ–¥–µ
- ‚úÖ –û–±–Ω–æ–≤–ª—è–µ—Ç –Ω–µ–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —É—Ä–æ–∫–∏ –≤ –ø—Ä–æ–¥–µ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ –ø–µ—Å–æ—á–Ω–∏—Ü—ã
- ‚úÖ –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–µ —É—Ä–æ–∫–∏, –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç –≤ –ø—Ä–æ–¥–µ
- ‚úÖ –ö–æ–ø–∏—Ä—É–µ—Ç –≤—Å–µ –¥–æ–º–∞—à–Ω–∏–µ –∏ –∫–ª–∞—Å—Å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã (LessonTask)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–µ–∂–∏–º –ø—Ä–æ–≤–µ—Ä–∫–∏ (dry-run) –±–µ–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- –î–æ—Å—Ç—É–ø –∫ –æ–±–µ–∏–º –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö (–ø–µ—Å–æ—á–Ω–∏—Ü–∞ –∏ –ø—Ä–æ–¥)
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ —Å URL –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
export SANDBOX_DATABASE_URL="postgresql://user:password@host:port/sandbox_db"
export PROD_DATABASE_URL="postgresql://user:password@host:port/prod_db"

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç
python scripts/sync_lessons_sandbox_to_prod.py
```

### –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

```bash
python scripts/sync_lessons_sandbox_to_prod.py \
  --sandbox-url "postgresql://user:password@host:port/sandbox_db" \
  --prod-url "postgresql://user:password@host:port/prod_db"
```

### –†–µ–∂–∏–º –ø—Ä–æ–≤–µ—Ä–∫–∏ (dry-run)

–ü–µ—Ä–µ–¥ —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –≤ —Ä–µ–∂–∏–º–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
python scripts/sync_lessons_sandbox_to_prod.py \
  --sandbox-url "..." \
  --prod-url "..." \
  --dry-run
```

–≠—Ç–æ –ø–æ–∫–∞–∂–µ—Ç, —á—Ç–æ –±—É–¥–µ—Ç —Å–¥–µ–ª–∞–Ω–æ, –±–µ–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

## –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å URL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –î–ª—è Railway

1. –ó–∞–π–¥–∏—Ç–µ –≤ –ø—Ä–æ–µ–∫—Ç –Ω–∞ Railway
2. –û—Ç–∫—Ä–æ–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (PostgreSQL)
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "Variables"
4. –ù–∞–π–¥–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `DATABASE_URL` –∏–ª–∏ `POSTGRES_URL`
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ

**–í–∞–∂–Ω–æ:** –î–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `DATABASE_EXTERNAL_URL` –∏–ª–∏ `POSTGRES_URL` –≤–º–µ—Å—Ç–æ `DATABASE_URL`.

### –ü—Ä–∏–º–µ—Ä URL

```
postgresql://postgres:password@containers-us-west-xxx.railway.app:5432/railway
```

## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

1. **–ü–æ–∏—Å–∫ —É—Ä–æ–∫–æ–≤**: –°–∫—Ä–∏–ø—Ç –ø–æ–ª—É—á–∞–µ—Ç –≤—Å–µ —É—Ä–æ–∫–∏ –∏–∑ –ø–µ—Å–æ—á–Ω–∏—Ü—ã
2. **–°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —É—á–µ–Ω–∏–∫–æ–≤**: –ù–∞—Ö–æ–¥–∏—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —É—á–µ–Ω–∏–∫–æ–≤ –≤ –ø—Ä–æ–¥–µ –ø–æ `platform_id`
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —É—Ä–æ–∫–∞**: –ò—â–µ—Ç —É—Ä–æ–∫ –≤ –ø—Ä–æ–¥–µ –ø–æ:
   - `student_id` (—É—á–µ–Ω–∏–∫)
   - `lesson_date` (–¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è)
   - `duration` (–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç–∏**: –£—Ä–æ–∫ —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º, –µ—Å–ª–∏ –µ—Å—Ç—å:
   - `topic` (—Ç–µ–º–∞)
   - `notes` (–∑–∞–º–µ—Ç–∫–∏)
   - `homework` (–¥–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ)
   - `homework_result_percent` –∏–ª–∏ `homework_result_notes`
5. **–î–µ–π—Å—Ç–≤–∏—è**:
   - –ï—Å–ª–∏ —É—Ä–æ–∫ –∑–∞–ø–æ–ª–Ω–µ–Ω ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è
   - –ï—Å–ª–∏ —É—Ä–æ–∫ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω ‚Üí –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
   - –ï—Å–ª–∏ —É—Ä–æ–∫–∞ –Ω–µ—Ç ‚Üí —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π
6. **–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π**: –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —É—Ä–æ–∫–∞ –∫–æ–ø–∏—Ä—É—é—Ç—Å—è –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ `LessonTask` (–¥–æ–º–∞—à–Ω–∏–µ –∏ –∫–ª–∞—Å—Å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã)

## –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
üöÄ –ó–∞–ø—É—Å–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —É—Ä–æ–∫–æ–≤ –∏–∑ –ø–µ—Å–æ—á–Ω–∏—Ü—ã –≤ –ø—Ä–æ–¥
============================================================
üîå –ü–æ–¥–∫–ª—é—á–∞—é—Å—å –∫ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö...
üìö –ü–æ–ª—É—á–∞—é —É—Ä–æ–∫–∏ –∏–∑ –ø–µ—Å–æ—á–Ω–∏—Ü—ã...
üìä –ù–∞–π–¥–µ–Ω–æ 15 —É—Ä–æ–∫–æ–≤ –≤ –ø–µ—Å–æ—á–Ω–∏—Ü–µ

üìù –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é —É—Ä–æ–∫ –æ—Ç 2025-01-15 14:00:00 –¥–ª—è —É—á–µ–Ω–∏–∫–∞ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤ (ID: student_123)
  ‚ûï –£—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –ø—Ä–æ–¥–µ - —Å–æ–∑–¥–∞—é –Ω–æ–≤—ã–π
  ‚úÖ –°–æ–∑–¥–∞–Ω —É—Ä–æ–∫ –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ 5 –∑–∞–¥–∞–Ω–∏–π

üìù –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é —É—Ä–æ–∫ –æ—Ç 2025-01-14 16:00:00 –¥–ª—è —É—á–µ–Ω–∏–∫–∞ –ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤ (ID: student_456)
  ‚úÖ –£—Ä–æ–∫ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω –≤ –ø—Ä–æ–¥–µ, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º

üìù –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é —É—Ä–æ–∫ –æ—Ç 2025-01-13 18:00:00 –¥–ª—è —É—á–µ–Ω–∏–∫–∞ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤ (ID: student_123)
  üîÑ –£—Ä–æ–∫ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω - –æ–±–Ω–æ–≤–ª—è—é –¥–∞–Ω–Ω—ã–µ
  ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω —É—Ä–æ–∫ –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ 3 –∑–∞–¥–∞–Ω–∏–π

============================================================
üìä –ò—Ç–æ–≥–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:
  ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: 12
  ‚è≠Ô∏è  –ü—Ä–æ–ø—É—â–µ–Ω–æ: 3
  ‚ùå –û—à–∏–±–æ–∫: 0
============================================================
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–∞–∂–Ω–æ:**
- –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Å–¥–µ–ª–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
- –°–Ω–∞—á–∞–ª–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –≤ —Ä–µ–∂–∏–º–µ `--dry-run` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ URL –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
- –°–∫—Ä–∏–ø—Ç –Ω–µ —É–¥–∞–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ, —Ç–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª—è–µ—Ç –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
- URL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞ –∏–∑ –≤–∞—à–µ–π —Å–µ—Ç–∏
- –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–µ—Ä–Ω—ã

### –£—á–µ–Ω–∏–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –ø—Ä–æ–¥–µ

–ï—Å–ª–∏ —É—á–µ–Ω–∏–∫ —Å `platform_id` –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –ø—Ä–æ–¥–µ, —É—Ä–æ–∫ –±—É–¥–µ—Ç –ø—Ä–æ–ø—É—â–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
- –£—á–µ–Ω–∏–∫ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ø—Ä–æ–¥–µ
- `platform_id` —Å–æ–≤–ø–∞–¥–∞–µ—Ç –≤ –æ–±–µ–∏—Ö –±–∞–∑–∞—Ö

### –ó–∞–¥–∞–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ –ø—Ä–æ–¥–µ

–ï—Å–ª–∏ `task_id` –∏–∑ –ø–µ—Å–æ—á–Ω–∏—Ü—ã –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ø—Ä–æ–¥–µ, –∑–∞–¥–∞–Ω–∏–µ –±—É–¥–µ—Ç –ø—Ä–æ–ø—É—â–µ–Ω–æ. –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –≤ –ø—Ä–æ–¥–µ –¥—Ä—É–≥–∞—è –≤–µ—Ä—Å–∏—è –∑–∞–¥–∞–Ω–∏–π.

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –õ–æ–≥–∏ —Å–∫—Ä–∏–ø—Ç–∞
2. –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
3. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü –≤ –æ–±–µ–∏—Ö –±–∞–∑–∞—Ö

